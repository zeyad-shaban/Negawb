{% extends 'categories/base.html' %}
{% load static %}
{% block title %} A social media platform to avoid distraction | Dfreemedia{% endblock title %}

{% block description %}We divide posts into topics, giving users the ability to hide topics to prevent getting
distracted between unwanted topics and focus on wanted once only.{% endblock description %}

{% block content %}
<ul class="list-group list-group-horizontal">
    {% if user.homepage_posts or not user.is_authenticated %}
    <li class="list-group-item active homepageView">Posts</li>
    <li class="list-group-item homepageView">Topics</li>
    {% else %}
    <li class="list-group-item active homepageView">Topics</li>
    {% endif %}

    {% if not user.hide_posts_in_homepage and user.is_authenticated %}
    <li class="list-group-item homepageView" id="toggleFriendsPosts">Friends Posts</li>
    <li class="list-group-item homepageView" style="overflow: hidden">Followed Posts</li>
    {% endif %}
</ul>
<!-- categories -->
<div class="homepageItem" id="categoryContainer" data-url="{% url 'userpage:get_user_by_id' %}" data-currUser="{{user}}"
    data-likeUrl="{% url 'comments:post_like_dislike' 1%}">
    <h1 class="text-center mb-3">Post topics</h1>
    <p>We divide posts into topics to prevent getting distracted between unwanted topics and focus on wanted once only.
        You can hide unwanted topics of posts from the Distraction Free menu in your <a
            href="{% url 'userpage:home' %}">profile</a>.
    </p>
    <div class="container-fluid">
        <div class="row">
            {% for category in categories %}
            <div class="col-md-4">
                <a href="{% url 'categories:view_category' category.id %}" class="text-white btn">
                    <div class="card text-white bg-{{category.display}} mb-3">
                        <div class="card-body">
                            <h5 class="card-title">{{ category.title }}</h5>
                            <p class="card-text">{{category.description}}.</p>
                            <a href="{% url 'categories:view_category' category.id %}" class="btn btn-dark">Visit</a>
                        </div>
                    </div>
                </a>
            </div>
            {% endfor %}
        </div>
    </div>
</div>

<!-- Homepage posts -->
{% if user.homepage_posts and user.is_authenticated or not user.is_authenticated %}
<div class="homepageItem" id="postsContainer">

    {% if not user.is_authenticated %}
    <h1 class="text-center">Homepage posts</h1>
    <p>Homepage posts are currently set for every topic of posts, you can change it from the Distraction Free menu if
        you are logged in</p>
    <p>Also you have to login to add posts</p>
    {% else %}
    <h1 class="text-center">{{ user.homepage_posts.title }}</h1>
    <link rel="stylesheet" href="{% static 'social/emojionearea.min.css' %}">
    <form method="POST" class="mb-4" enctype="multipart/form-data"
        action="{% url 'comments:create_post' user.homepage_posts.id %}">
        {% csrf_token %}
        <div class="form-group">
            <label for="id_post_description">Description</label>
            <textarea type="text" name="description" id="id_post_description" class="form-control"></textarea>
        </div>
        <div class="form-group">
            <p><label for="id_post_image">Optional Image</label>
                <input type="file" name="image" accept="image/*" id="id_image"></p>
        </div>
        <div class="form-group">
            <p><label for="id_post_image">Or Video</label>
                <input type="file" name="post_file" accept="video/*" id="id_post_file"></p>
        </div>
        <small class="form-text text-muted">You don't have to specify image or video, but if you do then only one of
            them</small>

        <input type="submit" value="Add Post" class="btn btn-success" id="addPostButton">
    </form>
    {% endif %}
    {% for post in homepage_posts %}
    <a href="{% url 'people:people' post.user.id %}">
        {% if post.user.who_see_avatar == 'everyone' %}
        <img src="{{post.user.avatar.url}}" alt="{{ post.user.username }}" width="64" height="64"
            class="mr-3 float-left {% if user.id <= 1000 %}oldUser{% endif %}" loading="lazy">
        {% elif post.user.who_see_avatar == 'friends' and user in post.user.friends.all %}
        <img src="{{post.user.avatar.url}}" alt="{{ post.user.username }}" width="64" height="64"
            class="mr-3 float-left {% if user.id <= 1000 %}oldUser{% endif %}" loading="lazy">
        {% elif post.user == user %}
        <img src="{{post.user.avatar.url}}" alt="{{ post.user.username }}" width="64" height="64"
            class="mr-3 float-left {% if user.id <= 1000 %}oldUser{% endif %}" loading="lazy">
        {% else %}
        <img src="/media/profile_images/DefaultUserImage.jpg" alt="{{ post.user.username }}" width="64" height="64"
            class="mr-3 float-left {% if user.id <= 1000 %}oldUser{% endif %}" loading="lazy">
        {% endif %}
        <span>{{post.user.username}}</span>
    </a>
    <a href="{% url 'people:people' post.user.id %}">
    </a>
    <div class="mb-3">
        <div class="card-body">
            {% if post.description %}
            <blockquote class="blockquote mb-0">
                <p class="text-break">{{post.description|truncatechars:450}} {% if post.description|length > 450%}<a
                        href="{% url 'comments:view_post' post.id %}">Read
                        More</a>{% endif %}</p>
            </blockquote>
            {% endif %}
            <small class="form-text text-muted">Published at {{ post.post_date|date:'d M Y' }}</small>

            {% if post.image %}
            <img src="{{ post.image.url }}" alt="{{ post.user.username }}" height="250" width="40%">
            {% elif post.post_file %}
            <video width="100%" controls class="col-md-10 col-lg-8">
                <source src="{{ post.post_file.url }}" type="video/mp4">
                <source src="{{ post.post_file.url }}" type="video/ogg">
                Your browser does not support the video tag.
            </video>
            {% endif %}
        </div>
    </div>
    <span class="row justify-content-center">
        <span><a href="{% url 'comments:view_post' post.id %}" style="text-decoration: none; color:black;"><i
                    class="far fa-comment-dots" style="font-size:36px;"></i></a></span>
        <!-- Like -->
        <form method="GET" id="likeForm{{post.id}}" class="form-inline">
            <button type="submit" name="submit" value="like" title="Like" class="btn btn-link">
                <i class="fa fa-thumbs-o-up" aria-hidden="true" style="font-size:36px" id="likeButton{{post.id}}"></i>
            </button>
        </form>
        <span class="m-3" id="id_likes{{post.id}}">
            {% if user in post.likes.all %}
            <p style="color:#065FD4;"><b>{{post.likes.count}}</b></p>
            {% else %}
            <p style="color:black;">{{post.likes.count}}</p>
            {% endif %}
        </span>
        <!-- add like script -->
        <script>
            document.addEventListener('DOMContentLoaded', function () {
                window.addEventListener('load', function () {
                    $('#likeForm{{post.id}}').click((event) => {
                        event.preventDefault()
                        $.ajax({
                            url: "{% url 'comments:post_like_dislike' post.id %}",
                            data: {
                                'submit': 'like',
                            },
                            method: 'get',
                            dataType: 'json',
                            success: function (data) {
                                let likes = "{{post.likes.count}}";
                                let dislikes = "{{ post.dislikes.count }}"
                                if (data.action == 'undislike_and_like') {
                                    dislikes -= 1
                                    likes++
                                    $('#id_dislikes{{post.id}}').html(
                                        '<p style="color:black;">' +
                                        dislikes + '</p>')
                                    $('#id_likes{{post.id}}').html(
                                        '<p style="color:#065FD4;"><b>' +
                                        likes + '</b></p>')
                                } else if (data.action == 'unlike') {
                                    likes -= 1
                                    $('#id_likes{{post.id}}').html(
                                        '<p style="color:#black;"' +
                                        likes +
                                        '</p>')
                                } else {
                                    likes++
                                    $('#id_likes{{post.id}}').html(
                                        '<p style="color:#065FD4;"><b>' +
                                        likes + '</b></p>')
                                }
                            }
                        })
                    })

                })
            })
        </script>
        <!-- Dislike -->
        <form action="{% url 'comments:post_like_dislike' post.id %}" method="post" class="form-inline"
            id="dislikeForm{{post.id}}">
            {% csrf_token %}
            <button type="submit" id="dislikeButton{{post.id}}" name="submit" value="dislike" title="Dislike"
                class="btn">
                <i class="fa fa-thumbs-o-down" aria-hidden="true" style="font-size:36px"></i>
            </button>
        </form>
        <span class="m-3" id="id_dislikes{{post.id}}">
            {% if user in post.dislikes.all %}
            <p style="color:#065FD4;"><b>{{post.dislikes.count}}</b></p>
            {% else %}
            <p style="color:black;">{{post.dislikes.count}}</p>
            {% endif %}
        </span>
        <!-- add like script -->
        <script>
            document.addEventListener('DOMContentLoaded', function () {
                window.addEventListener('load', function () {

                    $('#dislikeForm{{post.id}}').click((event) => {
                        event.preventDefault()
                    })
                    $('#dislikeButton{{post.id}}').click(function (event) {
                        $.ajax({
                            url: "{% url 'comments:post_like_dislike' post.id %}",
                            data: {
                                'submit': 'dislike',
                            },
                            dataType: 'json',
                            success: function (data) {
                                let likes = "{{post.likes.count}}";
                                let dislikes = "{{ post.dislikes.count }}"
                                if (data.action == 'unlike_and_dislike') {
                                    dislikes++
                                    likes -= 1
                                    $('#id_dislikes{{post.id}}').html(
                                        '<p style="color:#065FD4;"><b>' +
                                        dislikes + '</b></p>')
                                    $('#id_likes{{post.id}}').html(
                                        '<p style="color:black;">' +
                                        likes + '</p>')
                                } else if (data.action == 'undislike') {
                                    dislikes -= 1
                                    $('#id_dislikes{{post.id}}').html(
                                        '<p style="color:#black;"' +
                                        dislikes +
                                        '</p>')
                                } else {
                                    dislikes++
                                    $('#id_dislikes{{post.id}}').html(
                                        '<p style="color:#065FD4;"><b>' +
                                        dislikes + '</b></p>')
                                }
                            }
                        })
                    })

                })
            })
        </script>
    </span>
    {% endfor %}
</div>
{% endif %}

<div class="m-4">
    {% if not user.hide_posts_in_homepage %}
    <!-- FRIENDS POSTS -->
    <div id="friendsPosts" class="homepageItem">

        {% for post in friends_posts %}
        <a href="{% url 'people:people' post.user.id %}">
            {% if post.user.who_see_avatar == 'everyone' %}
            <img src="{{post.user.avatar.url}}" alt="{{ post.user.username }}" width="64" height="64"
                class="mr-3 float-left {% if user.id <= 1000 %}oldUser{% endif %}" loading="lazy">
            {% elif post.user.who_see_avatar == 'friends' and user in post.user.friends.all %}
            <img src="{{post.user.avatar.url}}" alt="{{ post.user.username }}" width="64" height="64"
                class="mr-3 float-left {% if user.id <= 1000 %}oldUser{% endif %}" loading="lazy">
            {% elif post.user == user %}
            <img src="{{post.user.avatar.url}}" alt="{{ post.user.username }}" width="64" height="64"
                class="mr-3 float-left {% if user.id <= 1000 %}oldUser{% endif %}" loading="lazy">
            {% else %}
            <img src="/media/profile_images/DefaultUserImage.jpg" alt="{{ post.user.username }}" width="64" height="64"
                class="mr-3 float-left {% if user.id <= 1000 %}oldUser{% endif %}" loading="lazy">
            {% endif %}
            <span>{{post.user.username}}</span>
        </a>
        <a href="{% url 'people:people' post.user.id %}">
        </a>
        <div class="mb-3">
            <div class="card-body">
                {% if post.description %}
                <blockquote class="blockquote mb-0">
                    <p class="text-break">{{post.description|truncatechars:450}} {% if post.description|length > 450%}<a
                            href="{% url 'comments:view_post' post.id %}">Read
                            More</a>{% endif %}</p>
                </blockquote>
                {% endif %}
                <small class="form-text text-muted">Published at {{ post.post_date|date:'d M Y' }}</small>

                {% if post.image %}
                <img src="{{ post.image.url }}" alt="{{ post.user.username }}" height="250" width="40%">
                {% elif post.post_file %}
                <video width="100%" controls class="col-md-10 col-lg-8">
                    <source src="{{ post.post_file.url }}" type="video/mp4">
                    <source src="{{ post.post_file.url }}" type="video/ogg">
                    Your browser does not support the video tag.
                </video>
                {% endif %}
            </div>
        </div>
        <span class="row justify-content-center">
            <span><a href="{% url 'comments:view_post' post.id %}" style="text-decoration: none; color:black;"><i
                        class="far fa-comment-dots" style="font-size:36px;"></i></a></span>
            <!-- Like -->
            <form method="GET" id="likeFriendForm{{post.id}}" class="form-inline">
                <button type="submit" name="submit" value="like" title="Like" class="btn btn-link">
                    <i class="fa fa-thumbs-o-up" aria-hidden="true" style="font-size:36px"
                        id="likeFriendButton{{post.id}}"></i>
                </button>
            </form>
            <span class="m-3" id="id_friendLikes{{post.id}}">
                {% if user in post.likes.all %}
                <p style="color:#065FD4;"><b>{{post.likes.count}}</b></p>
                {% else %}
                <p style="color:black;">{{post.likes.count}}</p>
                {% endif %}
            </span>

            <script>
                document.addEventListener('DOMContentLoaded', function () {
                    window.addEventListener('load', function () {

                        $('#likeFriendForm{{post.id}}').click((event) => {
                            event.preventDefault()
                        })
                        $('#likeFriendButton{{post.id}}').click(function (event) {
                            $.ajax({
                                url: "{% url 'comments:post_like_dislike' post.id %}",
                                data: {
                                    'submit': 'like',
                                },
                                method: 'get',
                                dataType: 'json',
                                success: function (data) {
                                    let likes = "{{post.likes.count}}";
                                    let dislikes = "{{ post.dislikes.count }}"
                                    if (data.action == 'undislike_and_like') {
                                        dislikes -= 1
                                        likes++
                                        $('#id_friendDislikes{{post.id}}').html(
                                            '<p style="color:black;">' +
                                            dislikes + '</p>')
                                        $('#id_friendLikes{{post.id}}').html(
                                            '<p style="color:#065FD4;"><b>' +
                                            likes + '</b></p>')
                                    } else if (data.action == 'unlike') {
                                        likes -= 1
                                        $('#id_friendLikes{{post.id}}').html(
                                            '<p style="color:#black;"' +
                                            likes +
                                            '</p>')
                                    } else {
                                        likes++
                                        $('#id_friendLikes{{post.id}}').html(
                                            '<p style="color:#065FD4;"><b>' +
                                            likes + '</b></p>')
                                    }
                                }
                            })
                        })

                    })
                })
            </script>

            <!-- Dislike -->
            <form action="{% url 'comments:post_like_dislike' post.id %}" method="post" class="form-inline"
                id="friendDislikeForm{{post.id}}">
                {% csrf_token %}
                <button type="submit" id="friendDislikeButton{{post.id}}" name="submit" value="dislike" title="Dislike"
                    class="btn">
                    <i class="fa fa-thumbs-o-down" aria-hidden="true" style="font-size:36px"></i>
                </button>
            </form>
            <span class="m-3" id="id_friendDislikes{{post.id}}">
                {% if user in post.dislikes.all %}
                <p style="color:#065FD4;"><b>{{post.dislikes.count}}</b></p>
                {% else %}
                <p style="color:black;">{{post.dislikes.count}}</p>
                {% endif %}
            </span>

            <script>
                document.addEventListener('DOMContentLoaded', function () {
                    window.addEventListener('load', function () {

                        $('#friendDislikeForm{{post.id}}').click((event) => {
                            event.preventDefault()
                        })
                        $('#friendDislikeButton{{post.id}}').click(function (event) {
                            $.ajax({
                                url: "{% url 'comments:post_like_dislike' post.id %}",
                                data: {
                                    'submit': 'dislike',
                                },
                                dataType: 'json',
                                success: function (data) {
                                    let likes = "{{post.likes.count}}";
                                    let dislikes = "{{ post.dislikes.count }}"
                                    if (data.action == 'unlike_and_dislike') {
                                        dislikes++
                                        likes -= 1
                                        $('#id_friendDislikes{{post.id}}').html(
                                            '<p style="color:#065FD4;"><b>' +
                                            dislikes + '</b></p>')
                                        $('#id_friendLikes{{post.id}}').html(
                                            '<p style="color:black;">' +
                                            likes + '</p>')
                                    } else if (data.action == 'undislike') {
                                        dislikes -= 1
                                        $('#id_friendDislikes{{post.id}}').html(
                                            '<p style="color:#black;"' +
                                            dislikes +
                                            '</p>')
                                    } else {
                                        dislikes++
                                        $('#id_friendDislikes{{post.id}}').html(
                                            '<p style="color:#065FD4;"><b>' +
                                            dislikes + '</b></p>')
                                    }
                                }
                            })
                        })

                    })
                })
            </script>

        </span>
    </div>
    {% endfor %}
    <!-- FRIENDS PAGINATOR -->
    <nav aria-label="..." id="friendsPaginator">
        <ul class="pagination">
            {% if friends_posts.has_previous%}
            <li class="page-item">
                <a href="?page={{ friends_posts.previous_page_number }}" class="page-link">&laquo</a>
            </li>
            {% endif %}
            {% for page in friends_posts.paginator.page_range %}
            {% if friends_posts.number == page %}
            <li class="page-item active">
                <a href="?page={{ page }}" class="page-link">{{ page }}</a>
            </li>
            {% else %}
            <li class="page-item">
                <a href="?page={{ page }}" class="page-link">{{ page }}</a>
            </li>
            {% endif %}
            {% endfor %}
            {% if friends_posts.has_next %}
            <li class="page-item">
                <a class="page-link" href="?page={{ friends_posts.next_page_number }}">&raquo</a>
            </li>
            {% endif %}
        </ul>
    </nav>
</div>




<!-- FOLLOWED POSTS -->
<div id="followedPosts" class="homepageItem">
    {% for followed in followed_users %}
    <a class="text-center showFollowed" data-pk="{{ followed.id }}">
        {% if followed.who_see_avatar == 'everyone' %}
        <img src="{{followed.avatar.url}}" class="{% if user.id <= 1000 %}oldUser{% endif %}" alt="User Image"
            width="64" height="64">
        {% elif followed.who_see_avatar == 'friends' and user in followed.friends.all %}
        <img src="{{followed.avatar.url}}" class="{% if user.id <= 1000 %}oldUser{% endif %}" alt="User Image"
            width="64" height="64">
        {% elif followed == user %}
        <img src="{{followed.avatar.url}}" class="{% if user.id <= 1000 %}oldUser{% endif %}" alt="User Image"
            width="64" height="64">
        {% else %}
        <img src="/media/profile_images/DefaultUserImage.jpg" class="{% if user.id <= 1000 %}oldUser{% endif %}"
            alt="User Image" width="64" height="64">
        {% endif %}
    </a>
    <p>{{followed.username}}</p>
    {% endfor %}

    <span id="followedPostsContainer">
        {% for post in followed_posts %}
        <a href="{% url 'people:people' post.user.id %}">
            {% if post.user.who_see_avatar == 'everyone' %}
            <img src="{{post.user.avatar.url}}" alt="{{ post.user.username }}" width="64" height="64"
                class="mr-3 float-left {% if user.id <= 1000 %}oldUser{% endif %}" loading="lazy">
            {% elif post.user.who_see_avatar == 'friends' and user in post.user.friends.all %}
            <img src="{{post.user.avatar.url}}" alt="{{ post.user.username }}" width="64" height="64"
                class="mr-3 float-left {% if user.id <= 1000 %}oldUser{% endif %}" loading="lazy">
            {% elif post.user == user %}
            <img src="{{post.user.avatar.url}}" alt="{{ post.user.username }}" width="64" height="64"
                class="mr-3 float-left {% if user.id <= 1000 %}oldUser{% endif %}" loading="lazy">
            {% else %}
            <img src="/media/profile_images/DefaultUserImage.jpg" alt="{{ post.user.username }}" width="64" height="64"
                class="mr-3 float-left {% if user.id <= 1000 %}oldUser{% endif %}" loading="lazy">
            {% endif %}
            <span>{{post.user.username}}</span>
        </a>
        <a href="{% url 'people:people' post.user.id %}">
        </a>
        <div class="mb-3">
            <div class="card-body">
                {% if post.description %}
                <blockquote class="blockquote mb-0">
                    <p class="text-break">{{post.description|truncatechars:450}} {% if post.description|length > 450%}<a
                            href="{% url 'comments:view_post' post.id %}">Read
                            More</a>{% endif %}</p>
                </blockquote>
                {% endif %}
                <small class="form-text text-muted">Published at {{ post.post_date|date:'d M Y' }}</small>

                {% if post.image %}
                <img src="{{ post.image.url }}" alt="{{ post.user.username }}" height="250" width="40%">
                {% elif post.post_file %}
                <video width="100%" controls class="col-md-10 col-lg-8">
                    <source src="{{ post.post_file.url }}" type="video/mp4">
                    <source src="{{ post.post_file.url }}" type="video/ogg">
                    Your browser does not support the video tag.
                </video>
                {% endif %}
            </div>
        </div>
        <span class="row justify-content-center">
            <span><a href="{% url 'comments:view_post' post.id %}" style="text-decoration: none; color:black;"><i
                        class="far fa-comment-dots" style="font-size:36px;"></i></a></span>
            <!-- Like -->
            <form method="GET" id="likeFollowedForm{{post.id}}" class="form-inline">
                <button type="submit" name="submit" value="like" UserAdmin.list_display +=('new_field',) # don't forget
                    the commas UserAdmin.list_filter +=('new_field',) UserAdmin.fieldsets +=('new_field',)="Like"
                    class="btn btn-link">
                    <i class="fa fa-thumbs-o-up" aria-hidden="true" style="font-size:36px"
                        id="likeFollowedButton{{post.id}}"></i>
                </button>
            </form>
            <span class="m-3" id="id_followedLikes{{post.id}}">
                {% if user in post.likes.all %}
                <p style="color:#065FD4;"><b>{{post.likes.count}}</b></p>
                {% else %}
                <p style="color:black;">{{post.likes.count}}</p>
                {% endif %}
            </span>

            <script>
                document.addEventListener('DOMContentLoaded', function () {
                    window.addEventListener('load', function () {

                        $('#likeFollowedForm{{post.id}}').click((event) => {
                            event.preventDefault()
                        })
                        $('#likeFollowedButton{{post.id}}').click(function (event) {
                            $.ajax({
                                url: "{% url 'comments:post_like_dislike' post.id %}",
                                data: {
                                    'submit': 'like',
                                },
                                method: 'get',
                                dataType: 'json',
                                success: function (data) {
                                    let likes = "{{post.likes.count}}";
                                    let dislikes = "{{ post.dislikes.count }}"
                                    if (data.action == 'undislike_and_like') {
                                        dislikes -= 1
                                        likes++
                                        $('#id_followedDislikes{{post.id}}')
                                            .html(
                                                '<p style="color:black;">' +
                                                dislikes + '</p>')
                                        $('#id_followedLikes{{post.id}}').html(
                                            '<p style="color:#065FD4;"><b>' +
                                            likes + '</b></p>')
                                    } else if (data.action == 'unlike') {
                                        likes -= 1
                                        $('#id_followedLikes{{post.id}}').html(
                                            '<p style="color:#black;"' +
                                            likes +
                                            '</p>')
                                    } else {
                                        likes++
                                        $('#id_followedLikes{{post.id}}').html(
                                            '<p style="color:#065FD4;"><b>' +
                                            likes + '</b></p>')
                                    }
                                }
                            })
                        })

                    })
                })
            </script>

            <!-- Dislike -->
            <form action="{% url 'comments:post_like_dislike' post.id %}" method="post" class="form-inline"
                id="followedDislikeForm{{post.id}}">
                {% csrf_token %}
                <button type="submit" id="followedDislikeButton{{post.id}}" name="submit" value="dislike"
                    title="Dislike" class="btn">
                    <i class="fa fa-thumbs-o-down" aria-hidden="true" style="font-size:36px"></i>
                </button>
            </form>
            <span class="m-3" id="id_followedDislikes{{post.id}}">
                {% if user in post.dislikes.all %}
                <p style="color:#065FD4;"><b>{{post.dislikes.count}}</b></p>
                {% else %}
                <p style="color:black;">{{post.dislikes.count}}</p>
                {% endif %}
            </span>

            <script>
                document.addEventListener('DOMContentLoaded', function () {
                    window.addEventListener('load', function () {

                        $('#followedDislikeForm{{post.id}}').click((event) => {
                            event.preventDefault()
                        })
                        $('#followedDislikeButton{{post.id}}').click(function (event) {
                            $.ajax({
                                url: "{% url 'comments:post_like_dislike' post.id %}",
                                data: {
                                    'submit': 'dislike',
                                },
                                dataType: 'json',
                                success: function (data) {
                                    let likes = "{{post.likes.count}}";
                                    let dislikes = "{{ post.dislikes.count }}"
                                    if (data.action == 'unlike_and_dislike') {
                                        dislikes++
                                        likes -= 1
                                        $('#id_followedDislikes{{post.id}}')
                                            .html(
                                                '<p style="color:#065FD4;"><b>' +
                                                dislikes + '</b></p>')
                                        $('#id_followedLikes{{post.id}}').html(
                                            '<p style="color:black;">' +
                                            likes + '</p>')
                                    } else if (data.action == 'undislike') {
                                        dislikes -= 1
                                        $('#id_followedDislikes{{post.id}}')
                                            .html(
                                                '<p style="color:#black;"' +
                                                dislikes +
                                                '</p>')
                                    } else {
                                        dislikes++
                                        $('#id_followedDislikes{{post.id}}')
                                            .html(
                                                '<p style="color:#065FD4;"><b>' +
                                                dislikes + '</b></p>')
                                    }
                                }
                            })
                        })

                    })
                })
            </script>

        </span>
        {% endfor %}
    </span>
</div>
</div>
{% else %}
<small class="from-text text-muted">Your Distraction Free settings doesn't allow posts to show in home page</small>
{% endif %}
</div>
<script src="{% static 'categories/index.js' %}"></script>
<link rel="stylesheet" href="{% static 'categories/index.css' %}">
{% endblock content %}