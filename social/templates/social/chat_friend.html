{% extends 'categories/base.html' %}
{% load static %}
{% block title %} {{friend.username}} | Chat {% endblock title %}
{% block searchbar %}

{% endblock searchbar %}
{% block content %}
<link rel="stylesheet" href="{% static 'social/chatstyle.css' %}">

{% for chat_message in chat_messages %}

{% if chat_message.message_sender == user %}
<div class="bubbleWrapper">
    <div class="inlineContainer own">
        {% if user.who_see_avatar == 'everyone' or user.who_see_avatar == 'friends' %}
        <img class="inlineIcon" src="{{ user.avatar.url }}">
        {% else %}
        <img class="inlineIcon" src="/media/profile_images/DefaultUserImage.png" alt={{user.username}}>
        {% endif %}

        {% if  chat_message.is_important%}
        <div class="ownBubble own" style="background: rgb(221, 62, 62);">
            {% else %}
            <div class="ownBubble own">
                {% endif %}
                <p>{{ chat_message.message }}</p>
            </div>
        </div><span class="own">{{ chat_message.sent_date }}</span>
    </div>


    {% elif chat_message.message_sender == friend %}
    <div class="bubbleWrapper">
        <div class="inlineContainer">
            {% if friend.who_see_avatar == 'everyone' or friend.who_see_avatar == 'friends' %}
            <img class="inlineIcon" src="{{ friend.avatar.url }}">
            {% else %}
            <img class="inlineIcon" src="/media/profile_images/DefaultUserImage.png" alt="{{firend.username}}">
            {% endif %}
            {% if  chat_message.is_important%}
            <div class="ownBubble own" style="background: rgb(221, 62, 62);">
                {% else %}
                <div class="otherBubble other">
                    {% endif %}
                    <p>{{ chat_message.message }}</p>
                </div>
            </div><span class="other">{{ chat_message.sent_date }}</span>
        </div>
        {% endif %}



        {% endfor %}




        <form action="" method="post" class="form-inline" enctype="multipart/form-data">
            {% csrf_token %}
            <input type="text" name="message" class="form-control" maxlength="50000"
                placeholder="Write something to send" required>
            <div class="input-group-text m-4" title="is important? you can only send 4/day">
                <input type="checkbox" name="is_important" aria-label="Checkbox for following text input" value="True">
            </div>
            <button type="submit" id="sendBtn"> <img src="{% static 'categories/SendButton.png' %}" width="150"
                    alt="Send" loading="lazy">
            </button>
        </form>
        {% endblock content %}